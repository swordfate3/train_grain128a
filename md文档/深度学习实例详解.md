# 深度学习实例详解：预测房价

## 问题描述
给定一个房屋数据集，包含以下特征：
- 面积（平方米）
- 房间数量
- 所在楼层
- 建筑年限
- 距地铁距离（米）

目标：预测房屋价格

## 1. 数据预处理

### 步骤1：数据标准化
就像把不同单位的数据统一到相同尺度：

**原始数据示例**：
```
面积：120平方米
房间：3间
楼层：12层
年限：5年
地铁距离：800米
```

**标准化过程**：
\[x_{标准化} = \frac{x - \mu}{\sigma}\]

例如处理面积数据：
```python
# 假设面积平均值是90，标准差是30
面积_标准化 = (120 - 90) / 30 = 1.0

# 其他特征同理
房间_标准化 = (3 - 3.5) / 1.2 = -0.42
楼层_标准化 = (12 - 15) / 8 = -0.375
```

## 2. 模型构建

### 步骤2：构建网络层
像搭积木一样逐层构建：

```python
model = Sequential([
    # 输入层：5个特征
    Dense(16, input_dim=5, activation='relu'),
    
    # 第一个残差块
    Dense(16, activation='relu'),
    # 跳跃连接
    Add(),  # 相当于捷径
    
    # 输出层
    Dense(1)  # 预测价格
])
```

**数值示例**：
```
输入: [1.0, -0.42, -0.375, -0.5, 0.2]

第一层变换:
1.0 * w1 + (-0.42) * w2 + ... = 0.8
经过ReLU: max(0, 0.8) = 0.8

残差连接:
原始值: 0.8
变换后: 0.9
最终值: 0.8 + 0.9 = 1.7
```

## 3. 训练过程

### 步骤3：设定学习率
循环学习率示例：

```python
第1轮：学习率 = 0.001
预测值：100万
实际值：120万
损失：|120-100| = 20万
参数更新：w = w - 0.001 * 20

第2轮：学习率 = 0.0008
预测值：110万
实际值：120万
损失：|120-110| = 10万
参数更新：w = w - 0.0008 * 10
```

## 4. 实际预测案例

### 案例1：市中心小户型
```
输入特征：
- 面积：50平方米 → 标准化后：-1.33
- 房间：1间 → 标准化后：-2.08
- 楼层：20层 → 标准化后：0.625
- 年限：2年 → 标准化后：1.5
- 地铁距离：200米 → 标准化后：1.2

预测过程：
1. 第一层变换：[-1.33, -2.08, 0.625, 1.5, 1.2] → [0.8, 0.6, 0.9]
2. 残差块处理：[0.8, 0.6, 0.9] + [0.7, 0.5, 0.8] = [1.5, 1.1, 1.7]
3. 输出层：预测价格 = 320万
```

### 案例2：郊区大户型
```
输入特征：
- 面积：150平方米 → 标准化后：2.0
- 房间：4间 → 标准化后：0.42
- 楼层：6层 → 标准化后：-1.125
- 年限：10年 → 标准化后：-0.5
- 地铁距离：1500米 → 标准化后：-1.0

预测过程：
1. 第一层变换：[2.0, 0.42, -1.125, -0.5, -1.0] → [1.2, 0.9, 0.7]
2. 残差块处理：[1.2, 0.9, 0.7] + [1.1, 0.8, 0.6] = [2.3, 1.7, 1.3]
3. 输出层：预测价格 = 280万
```

## 5. 模型评估

### 准确度计算
```
预测值：[320, 280, 450, 380]
实际值：[325, 285, 440, 390]

平均误差：
|320-325| + |280-285| + |450-440| + |380-390| / 4
= (5 + 5 + 10 + 10) / 4
= 7.5万
```

## 6. 调优过程

### 实例：处理过拟合
```
训练集表现：
第1轮：误差 20万
第10轮：误差 5万
第50轮：误差 1万

验证集表现：
第1轮：误差 22万
第10轮：误差 15万
第50轮：误差 25万 ← 开始过拟合
```

解决方案：
1. 增加正则化
2. 减少网络层数
3. 提前停止在第10轮

## 7. 实用技巧

### 数据分析
```
特征重要性分析：
面积 → 相关系数 0.8
地铁距离 → 相关系数 -0.6
房间数 → 相关系数 0.5
年限 → 相关系数 -0.3
楼层 → 相关系数 0.2
```

### 参数调优记录表
```
模型版本 | 学习率 | 批大小 | 训练误差 | 验证误差
v1      | 0.001  | 32     | 15万     | 18万
v2      | 0.0008 | 64     | 12万     | 14万
v3      | 0.0005 | 64     | 10万     | 11万
```